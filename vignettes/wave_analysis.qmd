---
title: "Wave Analysis Dashboard"
format:
  dashboard:
    orientation: rows
    theme: cosmo
execute:
  echo: false
  warning: false
  message: false
---

```{r setup}
#| include: false

# Load package
if (requireNamespace("pkgload", quietly = TRUE) && file.exists("../DESCRIPTION")) {
  pkgload::load_all("..", quiet = TRUE)
} else {
  library(irishbuoys)
}

library(dplyr)
library(ggplot2)
library(plotly)
library(DT)
library(dygraphs)
library(xts)
library(tidyr)
library(targets)

theme_set(theme_minimal(base_size = 12))

# Set targets store to project root
targets::tar_config_set(store = "../_targets")

# Load targets data only - generate plots inline to keep file size small
# NOTE: Pre-computed plotly objects embed all data as JSON (20MB+)
#       Generating inline from summary data keeps file ~1-2MB
targets::tar_load(c(
  full_data,
  missing_data_grid,
  rogue_wave_events,
  rogue_wave_conditions,
  rogue_wave_statistics,
  analysis_summary,
  seasonal_means_wave,
  seasonal_means_wind,
  wave_height_seasonal,
  annual_trends_wave,
  annual_trends_wind,
  gpd_wave_per_station,
  gpd_wind_per_station,
  gpd_hmax_per_station,
  gev_wave_pooled,
  gev_wind_pooled,
  gev_hmax_pooled,
  return_levels_wave_pooled,
  return_levels_wind_pooled,
  return_levels_hmax_pooled,
  gust_factor_analysis,
  return_level_curves_wave,
  return_level_curves_wind
))

# Alias for compatibility
rogue_events <- rogue_wave_events
rogue_conditions <- rogue_wave_conditions
wave_stl <- wave_height_seasonal
gust_analysis <- gust_factor_analysis

# For return levels, use pooled GEV (illustrative)
return_levels_wave <- return_levels_wave_pooled
return_levels_wind <- return_levels_wind_pooled
return_levels_hmax <- return_levels_hmax_pooled

has_data <- !is.null(rogue_events) && nrow(rogue_events) > 0

# Get dataset date range for captions
if (!is.null(analysis_summary) && "data_summary" %in% names(analysis_summary)) {
  data_start <- format(analysis_summary$data_summary$date_range[1], "%Y-%m-%d")
  data_end <- format(analysis_summary$data_summary$date_range[2], "%Y-%m-%d")
  date_caption <- paste0(data_start, " to ", data_end)
} else if (has_data) {
  data_start <- format(min(rogue_events$time), "%Y-%m-%d")
  data_end <- format(max(rogue_events$time), "%Y-%m-%d")
  date_caption <- paste0(data_start, " to ", data_end)
} else {
  data_start <- "N/A"
  data_end <- "N/A"
  date_caption <- "N/A"
}

# Get package version
pkg_version <- tryCatch(
  as.character(packageVersion("irishbuoys")),
  error = function(e) {
    desc_file <- "../DESCRIPTION"
    if (file.exists(desc_file)) {
      desc <- read.dcf(desc_file)
      desc[1, "Version"]
    } else "dev"
  }
)
generated_time <- format(Sys.time(), "%Y-%m-%d %H:%M UTC")

# Helper function for DT tables
create_dt <- function(data, caption = "") {
  time_cols <- which(names(data) %in% c("time", "Time", "timestamp", "Timestamp"))

  dt <- datatable(
    data, caption = caption, filter = 'top', extensions = 'Buttons',
    options = list(
      pageLength = 15, dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel'),
      order = list(list(0, 'desc')), scrollX = TRUE,
      columnDefs = if (length(time_cols) > 0) list(list(width = '120px', targets = time_cols - 1)) else NULL
    ),
    class = 'cell-border stripe hover compact'
  )

  if (length(time_cols) > 0) {
    dt <- dt %>% DT::formatStyle(columns = time_cols, fontSize = '10px', whiteSpace = 'nowrap')
  }
  dt
}

# Beaufort scale classification (wind speed in m/s)
classify_beaufort <- function(ws) {
  cut(ws,
    breaks = c(-Inf, 10.7, 17.1, 24.4, 28.4, 32.6, Inf),
    labels = c("0-5 (Calm-Fresh)", "6-7 (Strong-Near Gale)",
               "8-9 (Gale-Severe)", "10 (Storm)",
               "11 (Violent Storm)", "12 (Hurricane)"),
    right = TRUE
  )
}

beaufort_colors <- c(
  "0-5 (Calm-Fresh)" = "#2166ac",
  "6-7 (Strong-Near Gale)" = "#4393c3",
  "8-9 (Gale-Severe)" = "#d6604d",
  "10 (Storm)" = "#f4a582",
  "11 (Violent Storm)" = "#b2182b",
  "12 (Hurricane)" = "#67001f"
)

# Common legend styling for all plotly plots
legend_style <- list(
  font = list(color = "#333333", size = 12),
  bgcolor = "rgba(255,255,255,0.9)",
  bordercolor = "#cccccc",
  borderwidth = 1
)
```

# Overview

## Row

### Column

**Wave Analysis Dashboard** for the Irish Weather Buoy Network. All analysis computed via `{targets}` pipeline.

::: {.callout-important}
## Rogue Wave Definition
A rogue wave has **Hmax/Hs > 2.0** (ratio of maximum individual wave to significant wave height).
:::

#### Data Structure

```{r overview-glimpse}
#| echo: false
if (!is.null(full_data)) {
  dplyr::glimpse(full_data)
}
```

### Column

#### Key Metrics

| Metric | Value |
|--------|-------|
| Rogue Wave Events | `r if(has_data) nrow(rogue_events) else "N/A"` |
| Stations Analyzed | `r if(has_data) length(unique(rogue_events$station_id)) else "N/A"` |
| Max Rogue Ratio | `r if(has_data) round(max(rogue_events$rogue_ratio), 2) else "N/A"` |
| Max Hmax Observed | `r if(has_data) round(max(rogue_events$hmax), 1) else "N/A"` m |
| Dataset Start | `r if(has_data) format(min(rogue_events$time), "%Y-%m-%d %H:%M UTC") else "N/A"` |
| Dataset End | `r if(has_data) format(max(rogue_events$time), "%Y-%m-%d %H:%M UTC") else "N/A"` |
| Days in Dataset | `r if(has_data) round(as.numeric(difftime(max(rogue_events$time), min(rogue_events$time), units="days"))) else "N/A"` |

*Analysis generated `r generated_time` using irishbuoys v`r pkg_version`*

## Row

### Column

#### Missing Data by Station

```{r overview-missing-data}
#| echo: false
if (!is.null(missing_data_grid)) {
  # Summarize missing data by station
  missing_summary <- missing_data_grid |>
    group_by(station_id) |>
    summarise(
      total_days = n(),
      days_with_wave = sum(n_wave_height > 0),
      days_with_wind = sum(n_wind_speed > 0),
      days_with_hmax = sum(n_hmax > 0),
      pct_wave = round(100 * days_with_wave / total_days, 1),
      pct_wind = round(100 * days_with_wind / total_days, 1),
      pct_hmax = round(100 * days_with_hmax / total_days, 1),
      .groups = "drop"
    )
  create_dt(missing_summary, "Data availability by station (% of days with observations)")
} else {
  cat("Missing data grid not available. Run targets::tar_make()")
}
```

# Rogue Waves

## Row

### Column {.tabset}

#### All Stations

```{r rogue-waves-all}
# Generate plot inline to keep file size small
create_plot_rogue_all(rogue_events)
```

#### Events by Station

Use the **range slider** at the bottom to zoom all panels to a specific time period.

```{r rogue-waves-by-station}
#| fig-height: 14
# Generate plot inline to keep file size small
create_plot_rogue_by_station(rogue_events)
```

#### Data Table

**rogue_ratio** = Hmax/Hs (wave). Values > 2.0 define a rogue wave event.
**gust_ratio** = Gust/Wind (wind). Values > 1.5 indicate a rogue gust.

```{r rogue-waves-table}
if (has_data) {
  rogue_events |>
    mutate(gust_ratio = round(gust / wind_speed, 2)) |>
    arrange(desc(rogue_ratio)) |>
    select(time, station_id, wave_height, hmax, rogue_ratio, wind_speed, gust, gust_ratio, atmospheric_pressure) |>
    mutate(
      time = format(time, "%Y-%m-%d %H:%M"),
      across(where(is.numeric), ~round(., 2))
    ) |>
    create_dt(paste0("Rogue Wave Events (rogue_ratio > 2.0). ",
                     format(min(rogue_events$time), "%Y-%m-%d"), " to ",
                     format(max(rogue_events$time), "%Y-%m-%d")))
}
```

# Rogue Gusts

::: {.callout-important}
## Rogue Gust Definition
A rogue gust has **Gust/Wind > 1.5** (ratio of peak gust to sustained wind speed).
This parallels the rogue wave definition (Hmax/Hs > 2.0).
:::

## Row

### Column {.tabset}

#### All Stations

```{r rogue-gusts-all}
# Generate plot inline - load rogue gust events first
targets::tar_load(rogue_gust_events)
if (!is.null(rogue_gust_events) && nrow(rogue_gust_events) > 0) {
  create_plot_rogue_gusts_all(rogue_gust_events)
}
```

#### Events by Station

Use the **range slider** at the bottom to zoom all panels to a specific time period.

```{r rogue-gusts-by-station}
#| fig-height: 14
# Generate plot inline
if (!is.null(rogue_gust_events) && nrow(rogue_gust_events) > 0) {
  create_plot_rogue_gusts_by_station(rogue_gust_events)
}
```

#### Data Table

**gust_ratio** = Gust/Wind. Values > 1.5 define a rogue gust event.

```{r rogue-gusts-table}
targets::tar_load(rogue_gust_events)
if (!is.null(rogue_gust_events) && nrow(rogue_gust_events) > 0) {
  rogue_gust_events |>
    arrange(desc(gust_ratio)) |>
    mutate(
      time = format(time, "%Y-%m-%d %H:%M"),
      across(where(is.numeric), ~round(., 2))
    ) |>
    create_dt(paste0("Rogue Gust Events (gust_ratio > 1.5). ",
                     format(min(rogue_gust_events$time), "%Y-%m-%d"), " to ",
                     format(max(rogue_gust_events$time), "%Y-%m-%d")))
}
```

#### vs Rogue Waves

Comparing wave rogue events (Hmax/Hs > 2.0) with gust rogue events (Gust/Wind > 1.5).

```{r rogue-gusts-vs-waves}
# Generate plot inline - need analysis_data for this
targets::tar_load(analysis_data)
create_plot_gusts_vs_waves(analysis_data)
```

# Definitions

## Row

### Column {width=50%}

#### Key Terms

| Term | Definition | Reference |
|------|------------|-----------|
| **Hs = H1/3 = 4σ** | All three mean the same: significant wave height = mean of highest 1/3 of waves = 4 × standard deviation of sea surface | [Longuet-Higgins 1952](https://doi.org/10.1357/002224052806645438) |
| **Hmax** | Maximum individual wave height in 17.5-min measurement period | Typically Hmax/Hs ~ 1.5-1.9 |
| **Rogue Wave** | Wave where **Hmax/Hs > 2.0** | [Dysthe 2008](https://doi.org/10.1146/annurev.fluid.40.111406.102203) |
| **Rogue Ratio** | = Hmax/Hs. Values > 2.0 indicate a rogue wave | Used in [Rogue Waves](#rogue-waves) |
| **Gust Ratio** | = Peak Gust / Sustained Wind. Typical value ~1.3 | Used in [Rogue Gusts](#rogue-gusts) |
| **Rogue Gust** | Observation where **Gust/Wind > 1.5** | Used in [Rogue Gusts](#rogue-gusts) |
| **GEV** | Generalized Extreme Value distribution for annual maxima | Used in [Annual Max Model](#annual-max-model) |
| **GPD** | Generalized Pareto Distribution for peaks over threshold | Used in [Annual Max Prediction](#annual-max-prediction) |
| **Return Level** | Value expected to be exceeded once per T years | Used in [Annual Max Model](#annual-max-model) |

### Column {width=50%}

#### Why Hs = H1/3 = 4σ

These three notations all mean the same thing:

- **Hs** = Significant wave height (common abbreviation)
- **H1/3** = Mean of highest 1/3 of waves (original definition)
- **4σ** = 4 × standard deviation of sea surface elevation

The equivalence arises from the [Rayleigh distribution](https://en.wikipedia.org/wiki/Rayleigh_distribution) of wave heights. For a narrow-banded wave spectrum, the theoretical relationship is **Hs = 4 × sqrt(m0)** where m0 is the variance of sea elevation.

#### Why 17.5-minute measurement?

- Statistical requirement: Need ~100+ waves for valid H1/3
- Wave periods typically 5-15 seconds → 17.5 min gives ~70-200 waves
- WMO recommends 20-30 minutes; 17.5 is the practical lower bound
- Trade-off: longer = better statistics, shorter = more temporal resolution

# Trends

## Row

### Column {.tabset}

#### Monthly Wave Height

```{r trends-monthly-wave}
# Generate plot inline
create_plot_monthly_wave(seasonal_means_wave)
```

#### Monthly Wave (Data)

```{r trends-monthly-wave-data}
if (!is.null(seasonal_means_wave) && "monthly" %in% names(seasonal_means_wave)) {
  seasonal_means_wave$monthly |>
    mutate(across(where(is.numeric), ~round(., 2))) |>
    create_dt(paste0("Monthly Wave Height Statistics (", date_caption, ")"))
}
```

#### Monthly Wind

```{r trends-monthly-wind}
# Generate plot inline
create_plot_monthly_wind(seasonal_means_wind)
```

#### Annual Trends

```{r trends-annual}
# Generate plot inline
create_plot_annual_trends(annual_trends_wave)
```

#### STL Decomposition

```{r trends-stl}
#| fig-width: 12
#| fig-height: 8
# Generate STL plot inline (ggplot2)
create_plot_stl(wave_height_seasonal)
```

# Annual Max Model

## Row

### Column {.tabset}

#### Wave Return Levels

```{r eva-wave-return}
# Generate plot inline
create_plot_return_levels(return_levels_wave, variable = "wave")
```

#### Wave Return (Data)

```{r eva-wave-return-data}
if (!is.null(return_levels_wave)) {
  return_levels_wave |>
    mutate(across(where(is.numeric), ~round(., 2))) |>
    create_dt("Wave Height Return Levels")
}
```

#### Wind Return Levels

```{r eva-wind-return}
# Generate plot inline
create_plot_return_levels(return_levels_wind, variable = "wind")
```

#### Hmax Return Levels

```{r eva-hmax-return}
# Generate plot inline
create_plot_return_levels(return_levels_hmax, variable = "hmax")
```

#### Summary Table

```{r eva-summary-table}
if (!is.null(return_levels_wave)) {
  bind_rows(
    if (!is.null(return_levels_wave)) return_levels_wave |> mutate(Variable = "Hs") else NULL,
    if (!is.null(return_levels_hmax)) return_levels_hmax |> mutate(Variable = "Hmax") else NULL,
    if (!is.null(return_levels_wind)) return_levels_wind |> mutate(Variable = "Wind") else NULL
  ) |>
    select(Variable, return_period, return_level, lower, upper) |>
    mutate(across(where(is.numeric), ~round(., 1))) |>
    create_dt("Return Levels Summary")
}
```

# Annual Max Prediction

## Row

### Column {.tabset}

#### 1. GPD Per-Station (Recommended)

The **Generalized Pareto Distribution (GPD)** with **Peaks Over Threshold (POT)** approach fits extremes per station using all exceedances above a high threshold (90%, 95%, or 99% quantile).

**Advantages over pooled GEV:**
- Uses many more data points (all exceedances, not just annual maxima)
- Station-specific return levels
- Multiple threshold sensitivity analysis

```{r eva-pred-gpd-station}
if (!is.null(gpd_wave_per_station)) {
  # Extract results for 95% threshold
  gpd_results <- lapply(names(gpd_wave_per_station), function(st) {
    res <- gpd_wave_per_station[[st]][["medium"]]
    if (!is.null(res) && is.null(res$error) && !is.null(res$scale)) {
      data.frame(
        station = st,
        threshold_pct = "95%",
        threshold_value = round(res$u, 2),
        n_exceedances = res$n_exceed,
        scale = round(as.numeric(res$scale), 3),
        shape = round(as.numeric(res$shape), 3),
        se_scale = round(as.numeric(res$se_scale), 4),
        se_shape = round(as.numeric(res$se_shape), 4),
        stringsAsFactors = FALSE
      )
    } else {
      NULL
    }
  })
  gpd_df <- do.call(rbind, gpd_results[!sapply(gpd_results, is.null)])
  if (!is.null(gpd_df) && nrow(gpd_df) > 0) {
    create_dt(gpd_df, "GPD Wave Height Parameters (95% threshold)")
  } else {
    cat("GPD results not available")
  }
} else {
  cat("GPD per-station data not available. Run targets::tar_make()")
}
```

#### 2. GPD Theory

The **Generalized Pareto Distribution** has CDF for exceedances $y = x - u$ above threshold $u$:

$$F(y) = 1 - \left(1 + \frac{\xi y}{\sigma}\right)^{-1/\xi}$$

with two parameters:

| Parameter | Symbol | Interpretation |
|-----------|--------|----------------|
| **Scale** | $\sigma$ | Spread of exceedances |
| **Shape** | $\xi$ | Tail behaviour (same as GEV) |

**Return levels** for T-year event:

$$z_T = u + \frac{\sigma}{\xi}\left[(n_y \lambda T)^\xi - 1\right]$$

where $n_y$ = observations per year, $\lambda$ = exceedance rate.

#### 3. Threshold Sensitivity

GPD results depend on threshold choice. Lower thresholds give more data but may violate asymptotic theory. The [mev](https://cran.r-project.org/package=mev) package provides diagnostics.

```{r eva-pred-threshold}
if (!is.null(gpd_wave_per_station)) {
  # Compare thresholds for one station (M3)
  if ("M3" %in% names(gpd_wave_per_station)) {
    m3_gpd <- gpd_wave_per_station[["M3"]]
    threshold_comparison <- lapply(names(m3_gpd), function(thr) {
      res <- m3_gpd[[thr]]
      if (!is.null(res) && is.null(res$error) && !is.null(res$scale)) {
        data.frame(
          threshold = thr,
          quantile = paste0(c(low = "90%", medium = "95%", high = "99%")[thr]),
          u = round(res$u, 2),
          n_exceed = res$n_exceed,
          scale = round(as.numeric(res$scale), 3),
          shape = round(as.numeric(res$shape), 3),
          stringsAsFactors = FALSE
        )
      } else {
        NULL
      }
    })
    thr_df <- do.call(rbind, threshold_comparison[!sapply(threshold_comparison, is.null)])
    if (!is.null(thr_df) && nrow(thr_df) > 0) {
      create_dt(thr_df, "Threshold sensitivity for M3 wave height")
    }
  }
}
```

#### 4. GEV Pooled (Illustrative)

::: {.callout-note}
## Limited sample size (n=8 years)
The pooled GEV analysis below is **illustrative only** due to only 8 annual maxima. The GPD per-station approach (Tab 1) is preferred.
:::

```{r eva-pred-gev-pooled}
if (!is.null(analysis_summary) && "gev_pooled_fits" %in% names(analysis_summary)) {
  gev_fits <- analysis_summary$gev_pooled_fits

  params_df <- data.frame(
    Variable = c("Hs (wave height)", "Hmax", "Wind speed"),
    Location = c(gev_fits$wave_height$parameters["location"],
                 gev_fits$hmax$parameters["location"],
                 gev_fits$wind_speed$parameters["location"]),
    Scale = c(gev_fits$wave_height$parameters["scale"],
              gev_fits$hmax$parameters["scale"],
              gev_fits$wind_speed$parameters["scale"]),
    Shape = c(gev_fits$wave_height$parameters["shape"],
              gev_fits$hmax$parameters["shape"],
              gev_fits$wind_speed$parameters["shape"]),
    N_years = c(gev_fits$wave_height$n_years,
                gev_fits$hmax$n_years,
                gev_fits$wind_speed$n_years)
  )
  params_df$Location <- round(params_df$Location, 2)
  params_df$Scale <- round(params_df$Scale, 3)
  params_df$Shape <- round(params_df$Shape, 3)

  create_dt(params_df, "GEV Parameter Estimates - Pooled (illustrative, n=8)")
} else {
  cat("GEV fit data not available")
}
```

#### 5. Future Work

::: {.callout-warning}
## Extensions for Production Use

**Spatial dependence modelling:** The [SpatialExtremes](https://cran.r-project.org/package=SpatialExtremes) package provides max-stable process models that account for joint extremes across stations.

**Bayesian approaches:** The [mev](https://cran.r-project.org/package=mev) package supports profile likelihood and Bayesian methods for improved uncertainty quantification.

**Storm propagation:** Cross-correlation lag analysis between stations could enable offshore-to-nearshore prediction with lead times.
:::

# Gust Factor

## Row

### Column {.tabset}

#### Overall Summary

**Gust Factor** = Peak Gust / Sustained Wind. Typical value ~1.3.
**Rogue Gust** threshold: GF > 1.5 (see [Rogue Gusts](#rogue-gusts) page for detailed analysis).

```{r gust-overall}
if (!is.null(gust_analysis) && "summary" %in% names(gust_analysis)) {
  gust_analysis$summary |>
    mutate(across(where(is.numeric), ~round(., 2))) |>
    create_dt("Gust Factor Statistics (All Stations Combined)")
} else {
  cat("Gust analysis not available. Run targets::tar_make()")
}
```

#### By Station

```{r gust-by-station}
if (!is.null(gust_analysis) && "by_station" %in% names(gust_analysis) && !is.null(gust_analysis$by_station)) {
  gust_analysis$by_station |>
    mutate(across(where(is.numeric), ~round(., 2))) |>
    create_dt("Gust Factor Statistics by Station. Stations with sufficient data for analysis.")
} else {
  cat("Station data not available")
}
```

#### By Wind Category

```{r gust-by-category}
# Generate plot inline
create_plot_gust_by_category(gust_analysis)
```

#### Wind Category (Data)

```{r gust-category-data}
if (!is.null(gust_analysis) && "by_station_category" %in% names(gust_analysis) && !is.null(gust_analysis$by_station_category)) {
  gust_analysis$by_station_category |>
    mutate(across(where(is.numeric), ~round(., 2))) |>
    create_dt("Gust Factor by Wind Category and Station")
} else if (!is.null(gust_analysis) && "by_category" %in% names(gust_analysis)) {
  gust_analysis$by_category |>
    mutate(across(where(is.numeric), ~round(., 2))) |>
    create_dt("Gust Factor by Wind Category")
}
```

#### Rogue Gusts

```{r gust-rogue}
# Generate plot inline
create_plot_rogue_gusts(gust_analysis)
```

# Reference

## Row

### Column {width=50%}

#### Key Definitions (with page links)

| Term | Definition | Used In |
|------|------------|---------|
| **Hs = H1/3 = 4σ** | Significant wave height = mean of highest 1/3 = 4×std dev | [Definitions](#definitions) |
| **Hmax** | Max individual wave in 17.5-min period | [Rogue Waves](#rogue-waves) |
| **Rogue Wave** | Hmax/Hs > 2.0 | [Rogue Waves](#rogue-waves) |
| **Rogue Gust** | Gust/Wind > 1.5 | [Rogue Gusts](#rogue-gusts) |
| **Gust Factor** | Peak Gust / Sustained Wind (~1.3 typical) | [Gust Factor](#gust-factor) |
| **STL** | Seasonal-Trend decomposition (Loess) | [Trends](#trends) |

#### Extreme Value Methods (with page links)

| Method | Description | Used In |
|--------|-------------|---------|
| **GEV** | Block maxima (annual max, n=8) | [Annual Max Model](#annual-max-model) |
| **GPD** | Peaks over threshold (all exceedances) | [Annual Max Prediction](#annual-max-prediction) |
| **Return Level** | Value exceeded once per T years | Both EVA pages |

### Column {width=50%}

#### Beaufort Wind Scale

| Beaufort | Description | Wind Speed (m/s) |
|----------|-------------|-------------------|
| 0-5 | Calm to Fresh Breeze | 0 - 10.7 |
| 6-7 | Strong Breeze to Near Gale | 10.8 - 17.1 |
| 8-9 | Gale to Severe Gale | 17.2 - 24.4 |
| 10 | Storm | 24.5 - 28.4 |
| 11 | Violent Storm | 28.5 - 32.6 |
| 12 | Hurricane Force | > 32.7 |

**References:**

- Longuet-Higgins, M.S. (1952). Statistical distribution of sea waves. *J. Marine Research*, 11, 245-266.
- Dysthe, K. et al. (2008). Oceanic rogue waves. *Ann. Rev. Fluid Mech.*, 40, 287-310.
- Coles, S. (2001). *Statistical Modeling of Extreme Values*. Springer.

---

*Analysis generated `r generated_time` using irishbuoys v`r pkg_version`*
